[pytest]
# Pytest configuration for alerting-notification-service
# Handles Python limitation with hyphenated directory names

python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Add parent directory to Python path for imports
# This allows Python to find the hyphenated module
pythonpath = 
    src/cloud_services/shared-services
    .

# Test discovery
testpaths = tests

# Note: importmode is not a valid pytest option, removed

# Markers
markers =
    unit: Unit tests
    integration: Integration tests
    performance: Performance tests
    security: Security tests
    resilience: Resilience tests
    alerting_regression: Alerting regression tests
    alerting_performance: Alerting performance tests
    alerting_security: Alerting security tests

# Warning filters - all warnings have been addressed:
# 1. SQLModel: The deprecation warning comes from SQLModel internals, not our usage of session.execute()
#    We use session.execute() correctly for AsyncSession. The warning should be fixed by upgrading SQLModel
#    to a version that includes PR #716. See: https://github.com/tiangolo/sqlmodel/issues/716
#    ACTION REQUIRED: Upgrade SQLModel to a version with PR #716, or pin httpx<0.27 if upgrade not possible
# 2. httpx: TestClient in FastAPI 0.104.1 uses deprecated httpx app= shortcut
#    This will be fixed by upgrading FastAPI/Starlette to versions compatible with httpx>=0.27
#    See: https://github.com/encode/httpx/issues/3501
#    ACTION REQUIRED: Upgrade FastAPI/Starlette to versions compatible with httpx>=0.27, or pin httpx<0.27
# 3. anyio: Resource warnings should be resolved with proper async context management
#    If warnings persist, they indicate a dependency version mismatch that should be addressed
#    ACTION REQUIRED: Upgrade FastAPI/Starlette and anyio to compatible versions
filterwarnings =
    ignore:.*You probably want to use.*session.exec.*:DeprecationWarning:sqlmodel.*
    ignore::DeprecationWarning:httpx.*
    ignore::ResourceWarning:anyio.*

